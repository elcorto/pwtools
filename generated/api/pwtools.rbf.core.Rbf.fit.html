<!DOCTYPE html>

<html lang="en" data-content_root="../../">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>pwtools.rbf.core.Rbf.fit &#8212; pwtools  documentation</title>
    <link rel="stylesheet" type="text/css" href="../../_static/pygments.css?v=fa44fd50" />
    <link rel="stylesheet" type="text/css" href="../../_static/alabaster.css?v=9121de03" />
    <script src="../../_static/documentation_options.js?v=5929fcd5"></script>
    <script src="../../_static/doctools.js?v=888ff710"></script>
    <script src="../../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script>window.MathJax = {"options": {"processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
    <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="next" title="pwtools.rbf.core.Rbf.fit_error" href="pwtools.rbf.core.Rbf.fit_error.html" />
    <link rel="prev" title="pwtools.rbf.core.Rbf.deriv_jax" href="pwtools.rbf.core.Rbf.deriv_jax.html" />
   
  <link rel="stylesheet" href="../../_static/custom.css" type="text/css" />
  
  
  <meta name="viewport" content="width=device-width, initial-scale=0.9, maximum-scale=0.9" />

  </head><body>
  <div class="document">
    
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
<p class="logo">
  <a href="../../index.html">
    <img class="logo" src="../../_static/logo.png" alt="Logo"/>
    
    <h1 class="logo logo-name">pwtools</h1>
    
  </a>
</p>






<p>
<iframe src="https://ghbtns.com/github-btn.html?user=elcorto&repo=pwtools&type=watch&count=true&size=large&v=2"
  allowtransparency="true" frameborder="0" scrolling="0" width="200px" height="35px"></iframe>
</p>





<h3>Navigation</h3>
<ul class="current">
<li class="toctree-l1 current"><a class="reference internal" href="index.html">API Reference</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../written/features.html">Features</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../written/install.html">Installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../written/tutorial.html">Tutorial</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../written/background/index.html">Background, details, special topics</a></li>
</ul>

<div class="relations">
<h3>Related Topics</h3>
<ul>
  <li><a href="../../index.html">Documentation overview</a><ul>
  <li><a href="index.html">API Reference</a><ul>
  <li><a href="__sphinx_autodoc_module__pwtools.rbf.core.html">rbf.core</a><ul>
  <li><a href="pwtools.rbf.core.Rbf.html">pwtools.rbf.core.Rbf</a><ul>
      <li>Previous: <a href="pwtools.rbf.core.Rbf.deriv_jax.html" title="previous chapter">pwtools.rbf.core.Rbf.deriv_jax</a></li>
      <li>Next: <a href="pwtools.rbf.core.Rbf.fit_error.html" title="next chapter">pwtools.rbf.core.Rbf.fit_error</a></li>
  </ul></li>
  </ul></li>
  </ul></li>
  </ul></li>
</ul>
</div>
<div id="searchbox" style="display: none" role="search">
  <h3 id="searchlabel">Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="../../search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false"/>
      <input type="submit" value="Go" />
    </form>
    </div>
</div>
<script>document.getElementById('searchbox').style.display = "block"</script>
        </div>
      </div>
      <div class="documentwrapper">
        <div class="bodywrapper">
          

          <div class="body" role="main">
            
  <section id="pwtools-rbf-core-rbf-fit">
<h1>pwtools.rbf.core.Rbf.fit<a class="headerlink" href="#pwtools-rbf-core-rbf-fit" title="Link to this heading">¶</a></h1>
<dl class="py method">
<dt class="sig sig-object py" id="pwtools.rbf.core.Rbf.fit">
<span class="sig-prename descclassname"><span class="pre">Rbf.</span></span><span class="sig-name descname"><span class="pre">fit</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/pwtools/rbf/core.html#Rbf.fit"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pwtools.rbf.core.Rbf.fit" title="Link to this definition">¶</a></dt>
<dd><p>Solve linear system for the weights.</p>
<p>The weights  <cite>self.w</cite> (<span class="math notranslate nohighlight">\(\mathbf w\)</span>) are found from: <span class="math notranslate nohighlight">\(\mathbf
G\,\mathbf w = \mathbf z\)</span> or if <span class="math notranslate nohighlight">\(r\)</span> is given <span class="math notranslate nohighlight">\((\mathbf G +
r\,\mathbf I)\,\mathbf w = \mathbf z\)</span>.</p>
<p>with centers == points (center vectors are all data points). Then G is
quadratic. Updates <code class="docutils literal notranslate"><span class="pre">self.w</span></code>.</p>
<p class="rubric">Notes</p>
<dl class="simple">
<dt><code class="docutils literal notranslate"><span class="pre">self.r</span> <span class="pre">!=</span> <span class="pre">None</span></code><span class="classifier">linear system solver</span></dt><dd><p>For <span class="math notranslate nohighlight">\(r=0\)</span>, this always yields perfect interpolation at the
data points. May be numerically unstable in that case. Use
<span class="math notranslate nohighlight">\(r&gt;0\)</span> to increase stability (try small values such as
<code class="docutils literal notranslate"><span class="pre">1e-10</span></code> first) or create smooth fitting (generate more stiff
functions with higher <cite>r</cite>). Behaves similar to <code class="docutils literal notranslate"><span class="pre">lstsq</span></code> but
appears to be numerically more stable (no small noise in solution)
.. but <cite>r</cite> it is another parameter that needs to be tuned.</p>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">self.r</span> <span class="pre">=</span> <span class="pre">None</span></code><span class="classifier">least squares solver</span></dt><dd><p>Use <a class="reference external" href="https://docs.scipy.org/doc/scipy/reference/generated/scipy.linalg.lstsq.html#scipy.linalg.lstsq" title="(in SciPy v1.11.2)"><code class="xref py py-func docutils literal notranslate"><span class="pre">scipy.linalg.lstsq()</span></code></a>. Numerically more stable than
direct solver w/o regularization. Will mostly be the same as
the interpolation result, but will not go thru all points for
very noisy data. May create small noise in solution (plot fit
with high point density). Much (up to 10x) slower that normal
linear solver when <code class="docutils literal notranslate"><span class="pre">self.r</span> <span class="pre">!=</span> <span class="pre">None</span></code>.</p>
</dd>
</dl>
</dd></dl>

</section>


          </div>
          
        </div>
      </div>
    <div class="clearer"></div>
  </div>
    <div class="footer">
      &copy;2023, Steve Schmerler.
      
      |
      Powered by <a href="http://sphinx-doc.org/">Sphinx 7.2.4</a>
      &amp; <a href="https://github.com/bitprophet/alabaster">Alabaster 0.7.13</a>
      
      |
      <a href="../../_sources/generated/api/pwtools.rbf.core.Rbf.fit.rst.txt"
          rel="nofollow">Page source</a>
    </div>

    

    
  </body>
</html>