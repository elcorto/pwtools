<!DOCTYPE html>

<html lang="en" data-content_root="../../">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>Parsing code output and using containers &#8212; pwtools  documentation</title>
    <link rel="stylesheet" type="text/css" href="../../_static/pygments.css?v=fa44fd50" />
    <link rel="stylesheet" type="text/css" href="../../_static/alabaster.css?v=3b47c8d5" />
    <script src="../../_static/documentation_options.js?v=5929fcd5"></script>
    <script src="../../_static/doctools.js?v=9a2dae69"></script>
    <script src="../../_static/sphinx_highlight.js?v=dc90522c"></script>
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="next" title="Velocity autocorrelation function and phonon DOS" href="phonon_dos.html" />
    <link rel="prev" title="Background, details, special topics" href="index.html" />
   
  <link rel="stylesheet" href="../../_static/custom.css" type="text/css" />
  

  
  

  </head><body>
  <div class="document">
    
      <div class="sphinxsidebar" role="navigation" aria-label="Main">
        <div class="sphinxsidebarwrapper">
<p class="logo">
  <a href="../../index.html">
    <img class="logo" src="../../_static/logo.png" alt="Logo" />
    
    <h1 class="logo logo-name">pwtools</h1>
    
  </a>
</p>






<p>
<iframe src="https://ghbtns.com/github-btn.html?user=elcorto&repo=pwtools&type=watch&count=true&size=large&v=2"
  allowtransparency="true" frameborder="0" scrolling="0" width="200px" height="35px"></iframe>
</p>





<h3>Navigation</h3>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../generated/api/index.html">API Reference</a></li>
</ul>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../features.html">Features</a></li>
<li class="toctree-l1"><a class="reference internal" href="../install.html">Installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../tutorial.html">Tutorial</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="index.html">Background, details, special topics</a><ul class="current">
<li class="toctree-l2 current"><a class="current reference internal" href="#">Parsing code output and using containers</a></li>
<li class="toctree-l2"><a class="reference internal" href="phonon_dos.html">Velocity autocorrelation function and phonon DOS</a></li>
<li class="toctree-l2"><a class="reference internal" href="qha.html">Quasi-harmonic approximation</a></li>
<li class="toctree-l2"><a class="reference internal" href="param_study.html">Parameter studies</a></li>
<li class="toctree-l2"><a class="reference internal" href="pwscf.html">Pwscf</a></li>
<li class="toctree-l2"><a class="reference internal" href="ase.html">Relation to ASE</a></li>
<li class="toctree-l2"><a class="reference internal" href="rbf.html">Radial Basis Function interpolation an regression</a></li>
<li class="toctree-l2"><a class="reference internal" href="coord_trans.html">Coordinate transformation</a></li>
</ul>
</li>
</ul>

<div class="relations">
<h3>Related Topics</h3>
<ul>
  <li><a href="../../index.html">Documentation overview</a><ul>
  <li><a href="../index.html">&lt;no title&gt;</a><ul>
  <li><a href="index.html">Background, details, special topics</a><ul>
      <li>Previous: <a href="index.html" title="previous chapter">Background, details, special topics</a></li>
      <li>Next: <a href="phonon_dos.html" title="next chapter">Velocity autocorrelation function and phonon DOS</a></li>
  </ul></li>
  </ul></li>
  </ul></li>
</ul>
</div>
<search id="searchbox" style="display: none" role="search">
  <h3 id="searchlabel">Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="../../search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false"/>
      <input type="submit" value="Go" />
    </form>
    </div>
</search>
<script>document.getElementById('searchbox').style.display = "block"</script>
        </div>
      </div>
      <div class="documentwrapper">
        <div class="bodywrapper">
          

          <div class="body" role="main">
            
  <section id="parsing-code-output-and-using-containers">
<span id="parsers-and-containers"></span><h1>Parsing code output and using containers<a class="headerlink" href="#parsing-code-output-and-using-containers" title="Link to this heading">¶</a></h1>
<section id="available-parsers">
<span id="parser-classes"></span><h2>Available parsers<a class="headerlink" href="#available-parsers" title="Link to this heading">¶</a></h2>
<p>A core feature of pwtools is a set of parsers for commonly used atomistic
simulation codes. The parsers are located in <a class="reference internal" href="../../generated/api/__sphinx_autodoc_module__pwtools.parse.html#module-pwtools.parse" title="pwtools.parse"><code class="xref py py-mod docutils literal notranslate"><span class="pre">parse</span></code></a>. These
parsers are available:</p>
<blockquote>
<div><div class="line-block">
<div class="line"><a class="reference internal" href="../../generated/api/pwtools.parse.CifFile.html#pwtools.parse.CifFile" title="pwtools.parse.CifFile"><code class="xref py py-class docutils literal notranslate"><span class="pre">CifFile</span></code></a></div>
<div class="line"><a class="reference internal" href="../../generated/api/pwtools.parse.PDBFile.html#pwtools.parse.PDBFile" title="pwtools.parse.PDBFile"><code class="xref py py-class docutils literal notranslate"><span class="pre">PDBFile</span></code></a></div>
<div class="line"><a class="reference internal" href="../../generated/api/pwtools.parse.PwSCFOutputFile.html#pwtools.parse.PwSCFOutputFile" title="pwtools.parse.PwSCFOutputFile"><code class="xref py py-class docutils literal notranslate"><span class="pre">PwSCFOutputFile</span></code></a></div>
<div class="line"><a class="reference internal" href="../../generated/api/pwtools.parse.PwMDOutputFile.html#pwtools.parse.PwMDOutputFile" title="pwtools.parse.PwMDOutputFile"><code class="xref py py-class docutils literal notranslate"><span class="pre">PwMDOutputFile</span></code></a></div>
<div class="line"><a class="reference internal" href="../../generated/api/pwtools.parse.PwVCMDOutputFile.html#pwtools.parse.PwVCMDOutputFile" title="pwtools.parse.PwVCMDOutputFile"><code class="xref py py-class docutils literal notranslate"><span class="pre">PwVCMDOutputFile</span></code></a></div>
<div class="line"><a class="reference internal" href="../../generated/api/pwtools.parse.CpmdSCFOutputFile.html#pwtools.parse.CpmdSCFOutputFile" title="pwtools.parse.CpmdSCFOutputFile"><code class="xref py py-class docutils literal notranslate"><span class="pre">CpmdSCFOutputFile</span></code></a></div>
<div class="line"><a class="reference internal" href="../../generated/api/pwtools.parse.CpmdMDOutputFile.html#pwtools.parse.CpmdMDOutputFile" title="pwtools.parse.CpmdMDOutputFile"><code class="xref py py-class docutils literal notranslate"><span class="pre">CpmdMDOutputFile</span></code></a></div>
<div class="line"><a class="reference internal" href="../../generated/api/pwtools.parse.Cp2kSCFOutputFile.html#pwtools.parse.Cp2kSCFOutputFile" title="pwtools.parse.Cp2kSCFOutputFile"><code class="xref py py-class docutils literal notranslate"><span class="pre">Cp2kSCFOutputFile</span></code></a></div>
<div class="line"><a class="reference internal" href="../../generated/api/pwtools.parse.Cp2kMDOutputFile.html#pwtools.parse.Cp2kMDOutputFile" title="pwtools.parse.Cp2kMDOutputFile"><code class="xref py py-class docutils literal notranslate"><span class="pre">Cp2kMDOutputFile</span></code></a></div>
<div class="line"><a class="reference internal" href="../../generated/api/pwtools.parse.Cp2kDcdMDOutputFile.html#pwtools.parse.Cp2kDcdMDOutputFile" title="pwtools.parse.Cp2kDcdMDOutputFile"><code class="xref py py-class docutils literal notranslate"><span class="pre">Cp2kDcdMDOutputFile</span></code></a></div>
<div class="line"><a class="reference internal" href="../../generated/api/pwtools.parse.Cp2kRelaxOutputFile.html#pwtools.parse.Cp2kRelaxOutputFile" title="pwtools.parse.Cp2kRelaxOutputFile"><code class="xref py py-class docutils literal notranslate"><span class="pre">Cp2kRelaxOutputFile</span></code></a></div>
<div class="line"><a class="reference internal" href="../../generated/api/pwtools.parse.LammpsTextMDOutputFile.html#pwtools.parse.LammpsTextMDOutputFile" title="pwtools.parse.LammpsTextMDOutputFile"><code class="xref py py-class docutils literal notranslate"><span class="pre">LammpsTextMDOutputFile</span></code></a></div>
<div class="line"><a class="reference internal" href="../../generated/api/pwtools.parse.LammpsDcdMDOutputFile.html#pwtools.parse.LammpsDcdMDOutputFile" title="pwtools.parse.LammpsDcdMDOutputFile"><code class="xref py py-class docutils literal notranslate"><span class="pre">LammpsDcdMDOutputFile</span></code></a></div>
</div>
</div></blockquote>
<p>The parsers called <code class="docutils literal notranslate"><span class="pre">*OutputFile</span></code> are for parsing simulation code output. The
others parse structure files (cif and pdb).</p>
<p>All parsers have a common API and can be used like</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">pp</span> <span class="o">=</span> <span class="n">PwSCFOutputFile</span><span class="p">(</span><span class="s1">&#39;pw.out&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pp</span><span class="o">.</span><span class="n">get_cell</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># or call all get_*() methods at once and access attributes</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pp</span><span class="o">.</span><span class="n">parse</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pp</span><span class="o">.</span><span class="n">cell</span>
</pre></div>
</div>
<p>The problem with using the parsers directly is that there are of course
differences between the codes. For instance, each one uses different units
(Bohr, Angstrom, Ry, Ha, eV, …). Also, not all structure attributes are
contained in the output of all codes. For example,
<a class="reference internal" href="../../generated/api/pwtools.parse.PwSCFOutputFile.html#pwtools.parse.PwSCFOutputFile" title="pwtools.parse.PwSCFOutputFile"><code class="xref py py-class docutils literal notranslate"><span class="pre">PwSCFOutputFile</span></code></a> will parse Cartesian atomic coordinates into
<code class="docutils literal notranslate"><span class="pre">pp.coords</span></code> and the unit cell into <code class="docutils literal notranslate"><span class="pre">pp.cell</span></code>. However, often we need to use
the fractional coordinates <code class="docutils literal notranslate"><span class="pre">pp.coords_frac</span></code>. This quantity is not present in
the PWscf output and thus <code class="docutils literal notranslate"><span class="pre">pp.coords_frac</span></code> will be None. However, we know
that we can manually calculate it from <code class="docutils literal notranslate"><span class="pre">coords</span></code> and <code class="docutils literal notranslate"><span class="pre">cell</span></code>.</p>
</section>
<section id="container-classes-structure-and-trajectory">
<span id="container-classes"></span><h2>Container classes <a class="reference internal" href="../../generated/api/pwtools.crys.Structure.html#pwtools.crys.Structure" title="pwtools.crys.Structure"><code class="xref py py-class docutils literal notranslate"><span class="pre">Structure</span></code></a> and <a class="reference internal" href="../../generated/api/pwtools.crys.Trajectory.html#pwtools.crys.Trajectory" title="pwtools.crys.Trajectory"><code class="xref py py-class docutils literal notranslate"><span class="pre">Trajectory</span></code></a><a class="headerlink" href="#container-classes-structure-and-trajectory" title="Link to this heading">¶</a></h2>
<p>In order to abstract away the differences between codes as much as possible, we
have implemented unified container classes. These classes are
<a class="reference internal" href="../../generated/api/pwtools.crys.Structure.html#pwtools.crys.Structure" title="pwtools.crys.Structure"><code class="xref py py-class docutils literal notranslate"><span class="pre">Structure</span></code></a> and <a class="reference internal" href="../../generated/api/pwtools.crys.Trajectory.html#pwtools.crys.Trajectory" title="pwtools.crys.Trajectory"><code class="xref py py-class docutils literal notranslate"><span class="pre">Trajectory</span></code></a>. The
former is used to represent a single crystal structure (unit cell, atom
coordinates, total energy, stress tensor, …). The latter represents a
sequence of structures, for instance an MD or relaxation run.</p>
<p>They have two important features:</p>
<ul class="simple">
<li><p>A defined set of units
(eV, Angstrom,…), to which all quantities are converted.</p></li>
<li><p>Calculate all missing
attributes automatically and thus provide a unified API.</p></li>
</ul>
<p>Note that the latter is a convenience feature and will also produce some
redundant data. You may want to <a class="reference internal" href="../tutorial.html#avoid-auto-calc"><span class="std std-ref">turn it off</span></a>
for parsing/storing big data.</p>
<p>The auto-calculation of missing properties in <a class="reference internal" href="../../generated/api/pwtools.crys.Trajectory.html#pwtools.crys.Trajectory" title="pwtools.crys.Trajectory"><code class="xref py py-class docutils literal notranslate"><span class="pre">Trajectory</span></code></a>
and <a class="reference internal" href="../../generated/api/pwtools.crys.Structure.html#pwtools.crys.Structure" title="pwtools.crys.Structure"><code class="xref py py-class docutils literal notranslate"><span class="pre">Structure</span></code></a> is done by trying to calculate all
properties for which there is a <code class="docutils literal notranslate"><span class="pre">get_*</span></code> method. For example, if a parser
finds <code class="docutils literal notranslate"><span class="pre">coords</span></code> and <code class="docutils literal notranslate"><span class="pre">cell</span></code> in the MD data, then in
<a class="reference internal" href="../../generated/api/pwtools.crys.Trajectory.html#pwtools.crys.Trajectory" title="pwtools.crys.Trajectory"><code class="xref py py-class docutils literal notranslate"><span class="pre">Trajectory</span></code></a> <code class="docutils literal notranslate"><span class="pre">coords_frac</span></code> is calculated from that.</p>
<p>You can of course use these classes to build new structures and trajectories by
hand (just as with <code class="docutils literal notranslate"><span class="pre">ase.Atoms</span></code>, or you use <a class="reference internal" href="../../generated/api/pwtools.crys.atoms2struct.html#pwtools.crys.atoms2struct" title="pwtools.crys.atoms2struct"><code class="xref py py-func docutils literal notranslate"><span class="pre">atoms2struct()</span></code></a>):</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">st</span> <span class="o">=</span> <span class="n">crys</span><span class="o">.</span><span class="n">Structure</span><span class="p">(</span><span class="n">coords_frac</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mi">0</span><span class="p">]</span><span class="o">*</span><span class="mi">3</span><span class="p">,</span> <span class="p">[</span><span class="mf">.5</span><span class="p">]</span><span class="o">*</span><span class="mi">3</span><span class="p">]),</span>
<span class="go">                        cryst_const=np.array([3.0]*3 + [60]*3),</span>
<span class="go">                        symbols=[&#39;Al&#39;,&#39;N&#39;])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">tr</span> <span class="o">=</span> <span class="n">crys</span><span class="o">.</span><span class="n">Trajectory</span><span class="p">(</span><span class="n">coords_frac</span><span class="o">=</span><span class="n">rand</span><span class="p">(</span><span class="mi">1000</span><span class="p">,</span><span class="mi">20</span><span class="p">,</span><span class="mi">3</span><span class="p">),</span>
<span class="go">                         cell=rand(1000,3,3),</span>
<span class="go">                         symbols=[&#39;H&#39;]*20)</span>
</pre></div>
</div>
<p>By doing this, the <a class="reference internal" href="../../generated/api/pwtools.crys.Structure.set_all.html#pwtools.crys.Structure.set_all" title="pwtools.crys.Structure.set_all"><code class="xref py py-meth docutils literal notranslate"><span class="pre">set_all()</span></code></a> method is
automatically called, which will calculate all possible attributes from the
input data (for example <code class="docutils literal notranslate"><span class="pre">st.coords</span></code>, <code class="docutils literal notranslate"><span class="pre">st.cell</span></code>).</p>
<p>However, some attributes may be undefined. For example, the <code class="docutils literal notranslate"><span class="pre">st</span></code> above will
have no <code class="docutils literal notranslate"><span class="pre">etot</span></code> or <code class="docutils literal notranslate"><span class="pre">stress</span></code> attribute (they are None), since that was not
defined in the input and there is no ways to calculate it, of course, whereas a
Structure returned by <a class="reference internal" href="../../generated/api/pwtools.io.read_pw_scf.html#pwtools.io.read_pw_scf" title="pwtools.io.read_pw_scf"><code class="xref py py-func docutils literal notranslate"><span class="pre">read_pw_scf()</span></code></a> will have that.</p>
<p>By using the <a class="reference internal" href="../../generated/api/pwtools.base.FlexibleGetters.dump.html#pwtools.base.FlexibleGetters.dump" title="pwtools.base.FlexibleGetters.dump"><code class="xref py py-meth docutils literal notranslate"><span class="pre">dump()</span></code></a> method, you can store
the object as binary file [using Python’s <code class="docutils literal notranslate"><span class="pre">pickle</span></code> module] for fast
re-loading later:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">st</span><span class="o">.</span><span class="n">dump</span><span class="p">(</span><span class="s1">&#39;struck.pk&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">st_loaded</span> <span class="o">=</span> <span class="n">io</span><span class="o">.</span><span class="n">read_pickle</span><span class="p">(</span><span class="s1">&#39;struck.pk&#39;</span><span class="p">)</span>
</pre></div>
</div>
<p>A Trajectory object can be viewed a list of Structure instances [even though it
is implemented differently due to efficiency: we use 3d numpy arrays], it
supports iteration and slicing, for example:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># extract first and last Structure objects</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">st_first</span> <span class="o">=</span> <span class="n">tr</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">st_last</span> <span class="o">=</span> <span class="n">tr</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># slice out a part of the trajectory</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">tr_middle</span> <span class="o">=</span> <span class="n">tr</span><span class="p">[</span><span class="mi">100</span><span class="p">:</span><span class="mi">500</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># use every 5th step</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">tr</span><span class="p">[::</span><span class="mi">5</span><span class="p">]</span>
</pre></div>
</div>
<p>Structure and Trajectory objects can also be freely concatenated into a new
Trajectory:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">tr_new</span> <span class="o">=</span> <span class="n">crys</span><span class="o">.</span><span class="n">concatenate</span><span class="p">((</span><span class="n">st1</span><span class="p">,</span> <span class="n">st2</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">tr_new</span> <span class="o">=</span> <span class="n">crys</span><span class="o">.</span><span class="n">concatenate</span><span class="p">((</span><span class="n">st</span><span class="p">,</span> <span class="n">tr</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">tr_new</span> <span class="o">=</span> <span class="n">crys</span><span class="o">.</span><span class="n">concatenate</span><span class="p">((</span><span class="n">tr1</span><span class="p">,</span> <span class="n">tr2</span><span class="p">,</span> <span class="n">st</span><span class="p">))</span>
</pre></div>
</div>
</section>
<section id="high-level-parsing-functions">
<span id="high-level-parsing"></span><h2>High-level parsing functions<a class="headerlink" href="#high-level-parsing-functions" title="Link to this heading">¶</a></h2>
<p>The most simple way to parse code output and get a container class is to use
the high-level functions in <a class="reference internal" href="../../generated/api/__sphinx_autodoc_module__pwtools.io.html#module-pwtools.io" title="pwtools.io"><code class="xref py py-mod docutils literal notranslate"><span class="pre">io</span></code></a>.</p>
<dl>
<dt>These return a <a class="reference internal" href="../../generated/api/pwtools.crys.Structure.html#pwtools.crys.Structure" title="pwtools.crys.Structure"><code class="xref py py-class docutils literal notranslate"><span class="pre">Structure</span></code></a>:</dt><dd><div class="line-block">
<div class="line"><a class="reference internal" href="../../generated/api/pwtools.io.read_cif.html#pwtools.io.read_cif" title="pwtools.io.read_cif"><code class="xref py py-func docutils literal notranslate"><span class="pre">read_cif()</span></code></a></div>
<div class="line"><a class="reference internal" href="../../generated/api/pwtools.io.read_pdb.html#pwtools.io.read_pdb" title="pwtools.io.read_pdb"><code class="xref py py-func docutils literal notranslate"><span class="pre">read_pdb()</span></code></a></div>
<div class="line"><a class="reference internal" href="../../generated/api/pwtools.io.read_pw_scf.html#pwtools.io.read_pw_scf" title="pwtools.io.read_pw_scf"><code class="xref py py-func docutils literal notranslate"><span class="pre">read_pw_scf()</span></code></a></div>
<div class="line"><a class="reference internal" href="../../generated/api/pwtools.io.read_cpmd_scf.html#pwtools.io.read_cpmd_scf" title="pwtools.io.read_cpmd_scf"><code class="xref py py-func docutils literal notranslate"><span class="pre">read_cpmd_scf()</span></code></a></div>
<div class="line"><a class="reference internal" href="../../generated/api/pwtools.io.read_cp2k_scf.html#pwtools.io.read_cp2k_scf" title="pwtools.io.read_cp2k_scf"><code class="xref py py-func docutils literal notranslate"><span class="pre">read_cp2k_scf()</span></code></a></div>
</div>
</dd>
<dt>These return a <a class="reference internal" href="../../generated/api/pwtools.crys.Trajectory.html#pwtools.crys.Trajectory" title="pwtools.crys.Trajectory"><code class="xref py py-class docutils literal notranslate"><span class="pre">Trajectory</span></code></a>:</dt><dd><div class="line-block">
<div class="line"><a class="reference internal" href="../../generated/api/pwtools.io.read_pw_md.html#pwtools.io.read_pw_md" title="pwtools.io.read_pw_md"><code class="xref py py-func docutils literal notranslate"><span class="pre">read_pw_md()</span></code></a></div>
<div class="line"><a class="reference internal" href="../../generated/api/pwtools.io.read_pw_vcmd.html#pwtools.io.read_pw_vcmd" title="pwtools.io.read_pw_vcmd"><code class="xref py py-func docutils literal notranslate"><span class="pre">read_pw_vcmd()</span></code></a></div>
<div class="line"><a class="reference internal" href="../../generated/api/pwtools.io.read_cpmd_md.html#pwtools.io.read_cpmd_md" title="pwtools.io.read_cpmd_md"><code class="xref py py-func docutils literal notranslate"><span class="pre">read_cpmd_md()</span></code></a></div>
<div class="line"><a class="reference internal" href="../../generated/api/pwtools.io.read_cp2k_md.html#pwtools.io.read_cp2k_md" title="pwtools.io.read_cp2k_md"><code class="xref py py-func docutils literal notranslate"><span class="pre">read_cp2k_md()</span></code></a></div>
<div class="line"><a class="reference internal" href="../../generated/api/pwtools.io.read_cp2k_md_dcd.html#pwtools.io.read_cp2k_md_dcd" title="pwtools.io.read_cp2k_md_dcd"><code class="xref py py-func docutils literal notranslate"><span class="pre">read_cp2k_md_dcd()</span></code></a></div>
<div class="line"><a class="reference internal" href="../../generated/api/pwtools.io.read_cp2k_relax.html#pwtools.io.read_cp2k_relax" title="pwtools.io.read_cp2k_relax"><code class="xref py py-func docutils literal notranslate"><span class="pre">read_cp2k_relax()</span></code></a></div>
<div class="line"><a class="reference internal" href="../../generated/api/pwtools.io.read_lammps_md_txt.html#pwtools.io.read_lammps_md_txt" title="pwtools.io.read_lammps_md_txt"><code class="xref py py-func docutils literal notranslate"><span class="pre">read_lammps_md_txt()</span></code></a></div>
<div class="line"><a class="reference internal" href="../../generated/api/pwtools.io.read_lammps_md_dcd.html#pwtools.io.read_lammps_md_dcd" title="pwtools.io.read_lammps_md_dcd"><code class="xref py py-func docutils literal notranslate"><span class="pre">read_lammps_md_dcd()</span></code></a></div>
</div>
</dd>
</dl>
<p>For example:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">st</span> <span class="o">=</span> <span class="n">io</span><span class="o">.</span><span class="n">read_pw_scf</span><span class="p">(</span><span class="s1">&#39;pw.out&#39;</span><span class="p">)</span> <span class="c1"># SCF run</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">st</span><span class="o">.</span><span class="n">etot</span>
<span class="go">-258.58148870118305</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">st</span><span class="o">.</span><span class="n">cell</span>
<span class="go">array([[-2.71536701,  0.        ,  2.71536701],</span>
<span class="go">       [ 0.        ,  2.71536701,  2.71536701],</span>
<span class="go">       [-2.71536701,  2.71536701,  0.        ]])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">tr</span> <span class="o">=</span> <span class="n">io</span><span class="o">.</span><span class="n">read_pw_md</span><span class="p">(</span><span class="s1">&#39;pw.out&#39;</span><span class="p">)</span> <span class="c1"># MD/relax run</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">tr</span><span class="o">.</span><span class="n">etot</span><span class="p">[:</span><span class="mi">5</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">array</span><span class="p">([</span><span class="o">-</span><span class="mf">17812.03671913</span><span class="p">,</span> <span class="o">-</span><span class="mf">17810.74831561</span><span class="p">,</span> <span class="o">-</span><span class="mf">17811.38315829</span><span class="p">,</span>
<span class="go">           -17808.90413645, -17807.96259264])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">plot</span><span class="p">(</span><span class="n">tr</span><span class="o">.</span><span class="n">etot</span><span class="p">)</span>
</pre></div>
</div>
<p>These functions use the appropriate parser class and transform the result of
the parsing to a <a class="reference internal" href="../../generated/api/pwtools.crys.Structure.html#pwtools.crys.Structure" title="pwtools.crys.Structure"><code class="xref py py-class docutils literal notranslate"><span class="pre">Structure</span></code></a> or
<a class="reference internal" href="../../generated/api/pwtools.crys.Trajectory.html#pwtools.crys.Trajectory" title="pwtools.crys.Trajectory"><code class="xref py py-class docutils literal notranslate"><span class="pre">Trajectory</span></code></a>. For example, what is essentially done is
simply:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># same as tr=io.read_pw_md(&#39;pw.out&#39;)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pp</span> <span class="o">=</span> <span class="n">parse</span><span class="o">.</span><span class="n">PwMDOutputFile</span><span class="p">(</span><span class="s1">&#39;pw.out&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">tr</span> <span class="o">=</span> <span class="n">pp</span><span class="o">.</span><span class="n">get_traj</span><span class="p">()</span>

<span class="gp">&gt;&gt;&gt; </span><span class="c1"># same as st=io.read_cp2k_scf(&#39;cp2k.out&#39;)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pp</span> <span class="o">=</span> <span class="n">parse</span><span class="o">.</span><span class="n">Cp2kSCFOutputFile</span><span class="p">(</span><span class="s1">&#39;cp2k.out&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">st</span> <span class="o">=</span> <span class="n">pp</span><span class="o">.</span><span class="n">get_struct</span><span class="p">()</span>
</pre></div>
</div>
<p>It is important to note that Structure and Trajectory instances built by hand
can be used in exactly the same way as those obtained by using one of the
<code class="docutils literal notranslate"><span class="pre">io.read_*()</span></code> functions.</p>
</section>
<section id="units">
<h2>Units<a class="headerlink" href="#units" title="Link to this heading">¶</a></h2>
<p>Each parser will (try to) return the “natural” units of each code:</p>
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>property</p></th>
<th class="head"><p>PWscf</p></th>
<th class="head"><p>CPMD</p></th>
<th class="head"><p>CP2K</p></th>
<th class="head"><p>LAMMPS (metal units)</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>length</p></td>
<td><p>Bohr</p></td>
<td><p>Bohr</p></td>
<td><p>Angstrom</p></td>
<td><p>Angstrom</p></td>
</tr>
<tr class="row-odd"><td><p>energy</p></td>
<td><p>Ry</p></td>
<td><p>Ha</p></td>
<td><p>Ha</p></td>
<td><p>eV</p></td>
</tr>
<tr class="row-even"><td><p>forces</p></td>
<td><p>Ry/Bohr</p></td>
<td><p>Ha/Bohr</p></td>
<td><p>Ha/Bohr</p></td>
<td><p>eV/Angstrom</p></td>
</tr>
<tr class="row-odd"><td><p>stress</p></td>
<td><p>kbar</p></td>
<td><p>kbar</p></td>
<td><p>bar[MD], GPa[SCF]</p></td>
<td><p>bar</p></td>
</tr>
<tr class="row-even"><td><p>temperature</p></td>
<td><p>K</p></td>
<td><p>K</p></td>
<td><p>K</p></td>
<td><p>K</p></td>
</tr>
<tr class="row-odd"><td><p>velocity</p></td>
<td><ul class="simple">
<li></li>
</ul>
</td>
<td><p>Bohr/thart (?)</p></td>
<td><p>Bohr/thart</p></td>
<td><p>Angstrom/ps</p></td>
</tr>
<tr class="row-even"><td><p>time</p></td>
<td><p>tryd</p></td>
<td><p>thart</p></td>
<td><p>thart</p></td>
<td><p>ps</p></td>
</tr>
</tbody>
</table>
<p>See <a class="reference internal" href="../../generated/api/__sphinx_autodoc_module__pwtools.constants.html#module-pwtools.constants" title="pwtools.constants"><code class="xref py py-mod docutils literal notranslate"><span class="pre">constants</span></code></a> for <cite>thart</cite> and <cite>tryd</cite>.</p>
<p>For PWscf, we also detect things like “ATOMIC_POSITIONS crystal | alat | bohr”
and transform accordingly. Nevertheless, <em>always</em> verify that the units you get
are the ones you expect!</p>
<p>In <a class="reference internal" href="../../generated/api/pwtools.crys.Structure.html#pwtools.crys.Structure" title="pwtools.crys.Structure"><code class="xref py py-class docutils literal notranslate"><span class="pre">Structure</span></code></a> and <a class="reference internal" href="../../generated/api/pwtools.crys.Trajectory.html#pwtools.crys.Trajectory" title="pwtools.crys.Trajectory"><code class="xref py py-class docutils literal notranslate"><span class="pre">Trajectory</span></code></a>, we have
units eV, Angstrom,…</p>
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>property</p></th>
<th class="head"><p>unit</p></th>
<th class="head"><p>SI</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>length</p></td>
<td><p>Angstrom</p></td>
<td><p>(1e-10 m)</p></td>
</tr>
<tr class="row-odd"><td><p>energy</p></td>
<td><p>eV</p></td>
<td><p>(1.602176487e-19 J)</p></td>
</tr>
<tr class="row-even"><td><p>forces</p></td>
<td><p>eV / Angstrom</p></td>
<td></td>
</tr>
<tr class="row-odd"><td><p>stress</p></td>
<td><p>GPa</p></td>
<td><p>(not eV/Angstrom**3)</p></td>
</tr>
<tr class="row-even"><td><p>temperature</p></td>
<td><p>K</p></td>
<td></td>
</tr>
<tr class="row-odd"><td><p>velocity</p></td>
<td><p>Angstrom / fs</p></td>
<td></td>
</tr>
<tr class="row-even"><td><p>time</p></td>
<td><p>fs</p></td>
<td><p>(1e-15 s)</p></td>
</tr>
<tr class="row-odd"><td><p>mass</p></td>
<td><p>amu</p></td>
<td><p>(1.6605387820000001e-27 kg)</p></td>
</tr>
</tbody>
</table>
</section>
</section>


          </div>
          
        </div>
      </div>
    <div class="clearer"></div>
  </div>
    <div class="footer">
      &#169;Steve Schmerler.
      
      |
      Powered by <a href="https://www.sphinx-doc.org/">Sphinx 7.4.7</a>
      &amp; <a href="https://alabaster.readthedocs.io">Alabaster 0.7.16</a>
      
      |
      <a href="../../_sources/written/background/parsing.rst.txt"
          rel="nofollow">Page source</a>
    </div>

    

    
  </body>
</html>